# 神経衰弱（イラスト版）要件定義 v1.3（シングルプレイ）

## 1. 概要 / ビジョン
- シンプル操作で1人でも楽しめる短時間の記憶ゲーム。
- 1セッション目安: 5–10分。何度もリトライ可能。
- ブラウザで手軽に遊べることを最優先（インストール不要）。

## 2. ターゲット / プラットフォーム
- 想定ユーザー: 友人・家族と一緒に遊ぶカジュアル層、全年齢。
- プラットフォーム: PC/スマホのモダンブラウザ（Chrome/Safari/Firefox/Edge 最新）。
- 画面向き: 縦横どちらでも可。スマホ最小幅 320px で可読性を担保。

## 3. コンテンツ / ルール
- カード構成: 10種類のイラスト × 各2枚 = 計20枚（10ペア）。
  - イラストテーマ例: 果物/車/動物 など。初期実装はシンプルなSVGまたは絵文字で代替可。
- ペア定義: 同一イラストの2枚で1ペア。
- プレイヤー: 1人用。
- スコア: 通常ペア = 1ポイント。残りペア数が5以下になってからのペア = 2ポイント。
- ミスマッチ表示時間: 1.0秒 表面表示後に自動で伏せる（そのまま続行）。
- クリア: すべてのペア獲得で終了し、合計スコアを表示。

## 4. コアゲームループ
1) スタートボタン押下
2) デッキ生成（10種類×2）→ シャッフル → 盤面へ配列（レスポンシブ）
3) プレイヤーが2枚めくる
   - 一致: ペア獲得、スコア加算、続行
   - 不一致: 1.0秒表示 → 自動で伏せる
4) すべてのペアが獲得されたら終了
5) リザルト表示（最終スコア）→「もう一度」ボタンで再スタート

## 5. UI/UX
- テーマカラー: 緑（カード裏、ボタン、アクセントに適用）。
- 画面構成:
  - タイトル/開始画面: 中央に「スタート」ボタンのみ。
  - ゲーム画面: 上部にスコア/残りペア表示、中央にカードグリッド、下部に最小限の操作。
  - 終了画面: 最終スコアと「もう一度」ボタンのみ。
- カード表現: 画像アセット不要のテキスト/絵文字/内製SVGで簡易表示（のちに差し替え可能）。
- フィードバック: フリップアニメーション、選択中の強調、入力ロック時の二重操作防止。
- アクセシビリティ: フォーカス可視化、カードに `aria-label` を付与（例: "リンゴ"）。コントラスト比はWCAG AA目標。
- 重要要件（新規）: 20枚のカードが、どの対応端末でもスクロール無しで同一画面内に収まること。
- Favicon/アイコン（新規）: ブラウザタブやホーム追加時に表示される「かわいい」アイコンを用意（緑系のワンポイント。例: 🍏 をモチーフにしたSVG）。

## 6. レイアウト / レスポンシブ
- 盤面は常に「スクロール無しで20枚全表示」を満たす。
  - 既定は 5×4 配置。狭小画面では列数を最適化（例: 4×5）し、カードサイズ・余白を自動縮小。
  - HUD（スコア/残りペア表示）はコンパクト化（1行・小さめフォント）し、盤面に最大限の高さを割り当てる。
  - 盤面領域高さ: `min(100vh - HUD/マージン, 利用可能高)` を基準にカードサイズを算出。
  - カード比率は 3:4 を維持。余白は最小限（4–8px）まで縮小可。
- 基準端末での検証（すべてスクロール無し・はみ出し無し）:
  - iPhone SE2 (375×667), iPhone 12 mini (360×780), Pixel 5 (393×851)
  - iPad 縦 (768×1024), 13" ノート (1280×720 以上)

## 7. 技術 / 実装方針
- ファイル分割: `index.html`（マークアップ）, `styles.css`（スタイル）, `script.js`（ロジック）。
- 依存: なし（純粋な HTML/CSS/JavaScript）。オフラインで動作。
- アセット: 初期は内製SVGや絵文字で10種類を表現。差し替え前提の拡張ポイントを残す。
- Favicon/アイコン: `favicon.svg` を基本とし、互換のため `favicon.png`（32×32）と `apple-touch-icon.png`（180×180）も用意。
  - `index.html` の `<head>` に以下を追加:
    - `<link rel="icon" href="/favicon.svg" type="image/svg+xml">`
    - `<link rel="icon" href="/favicon.png" sizes="32x32">`
    - `<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">`
    - `<meta name="theme-color" content="#146b3a">`（緑テーマに合わせる）
- 状態管理: メモリのみ（セーブ/ロードなし）。
- パフォーマンス目標: 初回描画 < 1s（一般的端末）、操作時 60fps を目標。
- 入力制御: 2枚目を選択して判定中は入力をロックし、三枚目以降の同時選択を防止。

## 8. 非機能要件
- ブラウザ互換: 最新主要ブラウザの現行バージョン。スマホは iOS 15+/Android 10+ を目安。
- エラー耐性: 同一カードの二度クリック、超高速タップ、多重入力にも破綻しない。
- セキュリティ/プライバシー: 外部通信なし、個人情報の取り扱いなし。
- レイアウト堅牢性: アドレスバーの表示/非表示や回転時の `vh` 変動に対しても盤面が1画面に収まるように再計算する（回転/リサイズイベントでカードサイズを再算出）。
- アイコン互換性: 主要ブラウザで favicon が表示され、iOS/Android のホーム追加でアイコンが欠落しない（PNG/Apple Touch対応）。

## 9. 例外・境界ケース
- 同一カードのダブルクリックは2枚目として扱わない。
- 判定中（1.0秒）に他カードを操作できない。
- 片方だけめくった状態でリサイズしても状態は維持。
- すべてのペア獲得で即時終了し、残カードは存在しない。

## 10. 受け入れ基準（MVP）
- スタート画面に「スタート」ボタンのみが表示される。
- ゲーム画面で20枚のカードが表示され、スクロール無しで1画面に収まる（縦横いずれの向きでも）。
- 1人で遊べる。ペア一致で続行、ミスマッチは1.0秒表示後に自動で伏せる。
- ペア一致の判定が正しく行われ、通常1点・残り5ペア以降2点が正しく加算される。
- 判定中の入力は無効化される。
- 終了時に最終スコアが正しく表示され、「もう一度」ボタンで完全に再試合できる（シャッフル・スコア初期化）。
- PC/スマホで表示崩れや操作不能がない。
- ブラウザタブに favicon（かわいい緑系アイコン）が表示され、iOS のホーム追加時に `apple-touch-icon.png` が使われる。

## 11. マイルストーン
- M0: 本要件定義の合意。
- M1: 画面骨組み（スタート/ゲーム/終了）と緑テーマの適用。
- M2: デッキ生成（10種×2）/シャッフル/グリッド描画/フリップ演出。
- M3: スコア管理、判定ロック、残り5ペアでの2点加算。
- M4: 終了判定、リザルト表示、リスタート。
- M5: レスポンシブ最適化、アクセシビリティ改善、軽微な磨き込み。

## 12. リスクと対応
- アセット調達: 初期はSVG/絵文字で代替し、後日差し替え可能に設計。
- モバイル操作性: タップ範囲を十分に確保（最小44px）、誤タップ防止の間隔確保。
- パフォーマンス: DOM要素の再計算/アニメ過多に注意。CSSトランスフォーム中心に。

## 13. 可変項目（将来拡張）
- テーマ切替（背景・カード裏の色違い）。
- 難易度（カード種類 6/8/10 の可変）。
- タイムアタック/手数記録、ランキング（ローカルの範囲）。
- キーボード操作/スクリーンリーダー最適化の強化。

---
本ドキュメントの内容で実装（MVP）を開始します。変更があれば本ファイルを更新します。
